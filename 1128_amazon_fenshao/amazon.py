#!/usr/bin/env python
# -*- coding:utf-8 -*-
"""
-------------------------------------------------
   File Name：     test
   Description :
   Author :        hayden_huang
   Date：          2018/11/28 20:15
-------------------------------------------------
"""

import aiohttp
import asyncio
from lxml.etree import HTML
import re
import random
import config

url_list = ['https://www.amazon.com/Amazon-Video/s/browse?node=2858778011&ref_=nav_em_T1_0_4_5_1__aiv', 'https://www.amazon.com/Prime-Video/s/browse?node=2676882011&ref_=nav_em_T1_0_4_5_2__aiv_piv', 'https://www.amazon.com/s/browse?filterId=OFFER_FILTER%3DSUBSCRIPTIONS&node=2858778011&ref_=nav_em_T1_0_4_5_3__nav_sa_aos', 'https://www.amazon.com/gp/browse.html?node=7589478011&ref_=nav_em_T1_0_4_5_4__aiv_shop', 'https://www.amazon.com/gp/video/watchlist/?ref_=nav_em_T1_0_4_5_5__aiv_wlst', 'https://www.amazon.com/gp/video/library?ref_=nav_em_T1_0_4_5_6__aiv_yvl', 'https://www.amazon.com/gp/feature.html?docId=1001423601&ref_=nav_em_T1_0_4_5_7__aiv_wtv', 'https://www.amazon.com/gp/video/getstarted?ref_=nav_em_T1_0_4_5_8__aiv_gs', 'https://www.amazon.com/s/browse?merchId=originals1&node=2858778011&ref_=nav_em_T1_0_4_5_1__nav_sa_org', 'https://www.amazon.com/s/browse?merchId=primevideokids&node=2858778011&ref_=nav_em_T1_0_4_5_2__nav_sa_org', 'https://www.amazon.com/s/browse?node=16932271011&nodeId=16932271011&ref_=nav_em_T1_0_4_5_3_CTPGNO', 'https://www.amazon.com/gp/dmusic/promotions/AmazonMusicUnlimited?ref_=nav_em_T1_0_4_4_1__dm_hf', 'https://www.amazon.com/gp/dmusic/promotions/PrimeMusic?ref_=nav_em_T1_0_4_4_2__dm_pm', 'https://www.amazon.com/gp/dmusic/mp3/player?ref_=nav_em_T1_0_4_4_3_dm_webplayer', 'https://www.amazon.com/gp/browse.html?node=5174&ref_=nav_em_T1_0_4_4_1__dm_cds_vinyl', 'https://www.amazon.com/gp/browse.html?node=163856011&ref_=nav_em_T1_0_4_4_2__dm_store_hf', 'https://www.amazon.com/dp/B06XCM9LJ4?ref_=nav_em_T1_0_4_8_1__k_ods_ha_rr', 'https://www.amazon.com/dp/B07H1QBW2L?ref_=nav_em_T1_0_4_8_2__k_ods_ha_lr', 'https://www.amazon.com/dp/B0792KTHKJ?ref_=nav_em_T1_0_4_8_3__ods_ha_echo_dt', 'https://www.amazon.com/dp/B077JFK5YH?ref_=nav_em_T1_0_4_8_4__ods_ha_echo_bk_nav', 'https://www.amazon.com/dp/B073SQYXTW?ref_=nav_em_T1_0_4_8_5__ods_ha_echo_rk', 'https://www.amazon.com/dp/B077SXWSRP?ref_=nav_em_T1_0_4_8_6__ods_ha_echo_bs', 'https://www.amazon.com/dp/B0753K4CWG?ref_=nav_em_T1_0_4_8_7__ods_ha_echo_mf', 'https://www.amazon.com/gp/browse.html?node=9818047011&ref_=nav_em_T1_0_4_8_8__ods_ha_echo_cp', 'https://www.amazon.com/dp/B01MZEEFNX?ref_=nav_em_T1_0_4_NaN_1__ods_ha_aucc_sl', 'https://www.amazon.com/dp/B07894S727?ref_=nav_em_T1_0_4_NaN_2__ods_ha_aucc_sp', 'https://www.amazon.com/gp/browse.html?node=17386948011&ref_=nav_em_T1_0_4_NaN_3__ods_emrg_vicc', 'https://www.amazon.com/gp/browse.html?node=6563140011&ref_=nav_em_T1_0_4_NaN_4__ods_ha_echo_ch', 'https://www.amazon.com/gp/browse.html?node=16067214011&ref_=nav_em_T1_0_4_8_1__ods_ha_alexa_ug', 'https://www.amazon.com/gp/help/customer/display.html?nodeId=201602060&ref_=nav_em_T1_0_4_8_2__ods_ha_con_help', 'https://www.amazon.com/gp/browse.html?node=13727921011&ref_=nav_em_T1_0_4_8_3__ods_ha_con_skills_st', 'https://www.amazon.com/dp/B01GEW27DA?ref_=nav_em_T1_0_4_9_1__k_ods_tab_an', 'https://www.amazon.com/dp/B0794RHPZD?ref_=nav_em_T1_0_4_9_2__k_ods_tab_kk', 'https://www.amazon.com/dp/B01J6RPGKG?ref_=nav_em_T1_0_4_9_3__k_ods_tab_sz', 'https://www.amazon.com/dp/B01J90MSDS?ref_=nav_em_T1_0_4_9_4__k_ods_tab_afk', 'https://www.amazon.com/dp/B078HQBS21?ref_=nav_em_T1_0_4_9_5__k_ods_tab_kket', 'https://www.amazon.com/dp/B079Z8PLYW?ref_=nav_em_T1_0_4_9_6__k_ods_tab_sket', 'https://www.amazon.com/gp/browse.html?node=370783011&ref_=nav_em_T1_0_4_9_7__ods_tab_acc', 'https://www.amazon.com/gp/browse.html?node=6669703011&ref_=nav_em_T1_0_4_9_8__ods_tab_catp', 'https://www.amazon.com/Instant-Video/s/browse?node=2858778011&ref_=nav_em_T1_0_4_9_1__ods_tab_con_aiv', 'https://www.amazon.com/gp/browse.html?node=3427287011&ref_=nav_em_T1_0_4_9_2__ods_tab_con_apps', 'https://www.amazon.com/gp/browse.html?node=163856011&ref_=nav_em_T1_0_4_9_3__ods_tab_con_music', 'https://www.amazon.com/gp/browse.html?node=154606011&ref_=nav_em_T1_0_4_9_4__ods_tab_con_books', 'https://www.amazon.com/gp/kindle/ku/sign-up/ui/rw/about?ref_=nav_em_T1_0_4_9_5__ods_tab_con_ku', 'https://www.amazon.com/dp/B01I499BNA?ref_=nav_em_T1_0_4_9_6__ods_tab_gno_ftu', 'https://www.amazon.com/gp/digital/fiona/redirect/newsstand/home/?ref_=nav_em_T1_0_4_9_7__ods_tab_con_news', 'https://www.amazon.com/gp/digital/fiona/manage?ref_=nav_em_T1_0_4_9_8__ods_tab_con_myf', 'https://www.amazon.com/dp/B079QHML21?ref_=nav_em_T1_0_4_10_1__ods_smp_mt_nav', 'https://www.amazon.com/dp/B00ZV9RDKK?ref_=nav_em_T1_0_4_10_2__k_ods_smp_tk', 'https://www.amazon.com/dp/B0791T9CV7?ref_=nav_em_T1_0_4_10_3__ods_smp_skl_nav', 'https://www.amazon.com/dp/B01J6A6H74?ref_=nav_em_T1_0_4_10_4__k_ods_smp_fk', 'https://www.amazon.com/gp/browse.html?node=8521791011&ref_=nav_em_T1_0_4_10_5__ods_smp_catp', 'https://www.amazon.com/Prime-Instant-Video/s/browse?node=2676882011&ref_=nav_em_T1_0_4_10_1__ods_tv_con_piv', 'https://www.amazon.com/gp/browse.html?node=10208590011&ref_=nav_em_T1_0_4_10_2__ods_tv_apps_chan', 'https://www.amazon.com/gp/browse.html?node=7031433011&ref_=nav_em_T1_0_4_10_3__ods_tv_con_gaming', 'https://www.amazon.com/clouddrive/home/?ref_=nav_em_T1_0_4_10_4__ods_tv_con_cd', 'https://www.amazon.com/dp/B00ZV9PXP2?ref_=nav_em_T1_0_4_11_1__k_ods_eink_bn', 'https://www.amazon.com/dp/B07CXG6C9W?ref_=nav_em_T1_0_4_11_2__k_ods_eink_sd_me', 'https://www.amazon.com/dp/B06XD5YCKX?ref_=nav_em_T1_0_4_11_3__k_ods_eink_wy', 'https://www.amazon.com/dp/B01KMSKNGU?ref_=nav_em_T1_0_4_11_4__k_ods_eink_keb', 'https://www.amazon.com/gp/browse.html?node=370783011&ref_=nav_em_T1_0_4_11_5__ods_eink_acc', 'https://www.amazon.com/gp/browse.html?node=6669702011&ref_=nav_em_T1_0_4_11_6__ods_eink_catp', 'https://www.amazon.com/gp/browse.html?node=1286228011&ref_=nav_em_T1_0_4_11_1__ods_eink_con_books', 'https://www.amazon.com/gp/browse.html?node=241646011&ref_=nav_em_T1_0_4_11_2__ods_eink_con_news', 'https://www.amazon.com/gp/kindle/ku/sign-up/ui/rw/about?ref_=nav_em_T1_0_4_11_3__ods_eink_con_ku', 'https://www.amazon.com/kindle-dbs/fd/prime-pr?ref_=nav_em_T1_0_4_11_4__ods_eink_con_pr', 'https://www.amazon.com/gp/feature.html?docId=1000493771&ref_=nav_em_T1_0_4_11_1__ods_eink_con_karl', 'https://read.amazon.com/?ref_=nav_em_T1_0_4_11_2__ods_eink_con_kcr', 'https://www.amazon.com/gp/digital/fiona/manage?ref_=nav_em_T1_0_4_11_3__ods_eink_con_myk', 'https://www.amazon.com/gp/browse.html?node=2350149011&ref_=nav_em_T1_0_4_25_1__adr_app', 'https://www.amazon.com/gp/browse.html?node=9209902011&ref_=nav_em_T1_0_4_25_2__adr_gam', 'https://www.amazon.com/coins?ref_=nav_em_T1_0_4_25_3__adr_coins', 'https://www.amazon.com/gp/feature.html?docId=1003016361&ref_=nav_em_T1_0_4_25_4__adr_dl', 'https://www.amazon.com/gp/feature.html?docId=1000645111&ref_=nav_em_T1_0_4_25_5__adr_amz', 'https://www.amazon.com/gp/mas/your-account/myapps?ref_=nav_em_T1_0_4_25_6__adr_yad', 'https://www.amazon.com/gp/browse.html?node=10329849011&ref_=nav_em_T1_0_4_3_1__afs_aaf', 'https://www.amazon.com/b?bbn=10329849011&node=16310231&ref_=nav_em_T1_0_4_3_2__afs_bev', 'https://www.amazon.com/b?bbn=10329849011&node=16318751&ref_=nav_em_T1_0_4_3_3__afs_bb', 'https://www.amazon.com/b?bbn=10329849011&node=371460011&ref_=nav_em_T1_0_4_3_4__afs_dce', 'https://www.amazon.com/b?bbn=10329849011&node=6459122011&ref_=nav_em_T1_0_4_3_5__afs_ff', 'https://www.amazon.com/b?bbn=10329849011&node=16318981&ref_=nav_em_T1_0_4_3_6__afs_fr', 'https://www.amazon.com/b?bbn=10329849011&node=371469011&ref_=nav_em_T1_0_4_3_7__afs_ms', 'https://www.amazon.com/b?bbn=10329849011&node=10755958011&ref_=nav_em_T1_0_4_3_8__afs_pm', 'https://www.amazon.com/b?bbn=10329849011&node=16322721&ref_=nav_em_T1_0_4_3_9__afs_sf', 'https://www.amazon.com/b?bbn=10329849011&node=16319281&ref_=nav_em_T1_0_4_3_10__afs_vg', 'https://www.amazon.com/b?bbn=10329849011&node=51572011&ref_=nav_em_T1_0_4_3_11__afs_hpc', 'https://www.amazon.com/b?bbn=10329849011&node=15342811&ref_=nav_em_T1_0_4_3_12__afs_hc', 'https://www.amazon.com/afx/lists/pastpurchases?ref_=nav_em_T1_0_4_3_13__afs_pp', 'https://www.amazon.com/l/?bbn=10329849011&node=13904808011&ref_=nav_em_T1_0_4_3_14__afs_fd', 'https://www.amazon.com/afx/lists/grocerylists?ref_=nav_em_T1_0_4_3_15__afs_gl', 'https://www.amazon.com/b?bbn=10329849011&node=14762495011&ref_=nav_em_T1_0_4_3_16__afs_nhs', 'https://www.amazon.com/gp/browse.html?node=283155&ref_=nav_em_T1_0_4_26_1__bo_t1', 'https://www.amazon.com/gp/browse.html?node=4&ref_=nav_em_T1_0_4_26_2__cbo_t1', 'https://www.amazon.com/gp/browse.html?node=2056775011&ref_=nav_em_T1_0_4_26_3__abebooks_t1', 'https://www.amazon.com/gp/browse.html?node=156104011&ref_=nav_em_T1_0_4_26_4__comicsgraphic', 'https://www.amazon.com/gp/browse.html?node=599858&ref_=nav_em_T1_0_4_26_5__magazines_t1', 'https://www.amazon.com/gp/browse.html?node=465600&ref_=nav_em_T1_0_4_26_6__tb_t1', 'https://www.amazon.com/gp/browse.html?node=5657188011&ref_=nav_em_T1_0_4_26_7__rentals_t1', 'https://www.amazon.com/gp/browse.html?node=2205237011&ref_=nav_em_T1_0_4_26_8__us_ti_tb_0513_t1', 'https://www.amazon.com/gp/browse.html?node=668781011&ref_=nav_em_T1_0_4_26_9__student_t1', 'https://www.amazon.com/gp/browse.html?node=1286228011&ref_=nav_em_T1_0_4_26_1__k_kbo_t1', 'https://www.amazon.com/gp/kindle/ku/sign-up/ui/rw/about?ref_=nav_em_T1_0_4_26_2__ods_books_con_ku_t1', 'https://www.amazon.com/kindle-dbs/fd/prime-pr?ref_=nav_em_T1_0_4_26_3__ods_eink_con_pr_t1', 'https://www.amazon.com/gp/browse.html?node=5744819011&ref_=nav_em_T1_0_4_26_4__aud_wfv_t1', 'https://www.amazon.com/dp/B00NB86OYE?ref_=nav_em_T1_0_4_26_1__aud_mem_t3', 'https://www.amazon.com/gp/browse.html?node=2402172011&ref_=nav_em_T1_0_4_26_2__aud_bks_t3', 'https://www.amazon.com/gp/browse.html?node=2625373011&ref_=nav_em_T1_0_4_14_1__mov', 'https://www.amazon.com/gp/browse.html?node=2901953011&ref_=nav_em_T1_0_4_14_2__blu', 'https://www.amazon.com/gp/browse.html?node=2858778011&ref_=nav_em_T1_0_4_14_3__atv', 'https://www.amazon.com/gp/browse.html?node=9013971011&ref_=nav_em_T1_0_4_14_4__video_shorts', 'https://www.amazon.com/gp/browse.html?node=5174&ref_=nav_em_T1_0_4_14_5__cd_vinyl', 'https://www.amazon.com/gp/browse.html?node=163856011&ref_=nav_em_T1_0_4_14_6__dmusic', 'https://www.amazon.com/gp/browse.html?node=11091801&ref_=nav_em_T1_0_4_14_7__mi', 'https://www.amazon.com/gp/browse.html?node=172541&ref_=nav_em_T1_0_4_14_8_headphones', 'https://www.amazon.com/gp/browse.html?node=468642&ref_=nav_em_T1_0_4_14_9__cvg', 'https://www.amazon.com/gp/browse.html?node=8588809011&ref_=nav_em_T1_0_4_14_10__pcgaming41516', 'https://www.amazon.com/gp/browse.html?node=979455011&ref_=nav_em_T1_0_4_14_11__gdown', 'https://www.amazon.com/gp/browse.html?node=5088769011&ref_=nav_em_T1_0_4_14_12__entcol', 'https://www.amazon.com/gp/browse.html?node=2242532011&ref_=nav_em_T1_0_4_14_13__trade_in_mmg', 'https://www.amazon.com/gp/browse.html?node=1266092011&ref_=nav_em_T1_0_4_13_1__tv', 'https://www.amazon.com/gp/browse.html?node=667846011&ref_=nav_em_T1_0_4_13_2__hat', 'https://www.amazon.com/gp/browse.html?node=502394&ref_=nav_em_T1_0_4_13_3__p', 'https://www.amazon.com/gp/browse.html?node=2335752011&ref_=nav_em_T1_0_4_13_4__wi', 'https://www.amazon.com/gp/browse.html?node=172541&ref_=nav_em_T1_0_4_13_5_headphones', 'https://www.amazon.com/gp/browse.html?node=468642&ref_=nav_em_T1_0_4_13_6__cvg_ce', 'https://www.amazon.com/gp/browse.html?node=322215011&ref_=nav_em_T1_0_4_13_7__bluetoothwireless', 'https://www.amazon.com/gp/browse.html?node=1077068&ref_=nav_em_T1_0_4_13_8__gps_ce', 'https://www.amazon.com/gp/browse.html?node=11091801&ref_=nav_em_T1_0_4_13_9__mi_ce', 'https://www.amazon.com/gp/browse.html?node=9013937011&ref_=nav_em_T1_0_4_13_10_wear_tech', 'https://www.amazon.com/gp/browse.html?node=172282&ref_=nav_em_T1_0_4_13_11__elec_hub', 'https://www.amazon.com/Low-Price-With-Free-Shipping/bbp?category=%2Felectronics&ref_=nav_em_T1_0_4_13_12_bbp_bb_a77114_in_sd_w_ur', 'https://www.amazon.com/gp/browse.html?node=17881058011&ref_=nav_em_T1_0_4_13_13_nav_cerenewed', 'https://www.amazon.com/gp/browse.html?node=541966&ref_=nav_em_T1_0_4_13_1__basedevices', 'https://www.amazon.com/gp/browse.html?node=1292115011&ref_=nav_em_T1_0_4_13_2__monitors', 'https://www.amazon.com/gp/browse.html?node=172456&ref_=nav_em_T1_0_4_13_3__compaccess', 'https://www.amazon.com/gp/browse.html?node=172504&ref_=nav_em_T1_0_4_13_4__networking', 'https://www.amazon.com/gp/browse.html?node=2248325011&ref_=nav_em_T1_0_4_13_5__storage', 'https://www.amazon.com/gp/browse.html?node=193870011&ref_=nav_em_T1_0_4_13_6__components', 'https://www.amazon.com/gp/browse.html?node=229534&ref_=nav_em_T1_0_4_13_7__sw', 'https://www.amazon.com/gp/browse.html?node=172635&ref_=nav_em_T1_0_4_13_8__printers', 'https://www.amazon.com/gp/browse.html?node=1064954&ref_=nav_em_T1_0_4_13_9__op', 'https://www.amazon.com/gp/browse.html?node=2226766011&ref_=nav_em_T1_0_4_13_10__trade_in_elec', 'https://www.amazon.com/gp/browse.html?node=13575748011&ref_=nav_em_T1_0_4_13_1_sbdshd_lighting', 'https://www.amazon.com/gp/browse.html?node=13575750011&ref_=nav_em_T1_0_4_13_2_sbdshd_plugs', 'https://www.amazon.com/gp/browse.html?node=16713337011&ref_=nav_em_T1_0_4_13_3_sbdshd_cameras', 'https://www.amazon.com/gp/browse.html?node=16334612011&ref_=nav_em_T1_0_4_13_4_sbdshd_door_locks', 'https://www.amazon.com/gp/browse.html?node=13575749011&ref_=nav_em_T1_0_4_13_5_sbdshd_thermostats', 'https://www.amazon.com/gp/browse.html?node=16713338011&ref_=nav_em_T1_0_4_13_6_sbdshd_tv_video', 'https://www.amazon.com/gp/browse.html?node=17284462011&ref_=nav_em_T1_0_4_13_7_sbdshd_aht', 'https://www.amazon.com/gp/browse.html?node=17934444011&ref_=nav_em_T1_0_4_13_8_sbdshd_vac', 'https://www.amazon.com/gp/browse.html?node=9818047011&ref_=nav_em_T1_0_4_13_9_sbdshd_v_a', 'https://www.amazon.com/gp/browse.html?node=16334613011&ref_=nav_em_T1_0_4_13_10_sbdshd_o_s', 'https://www.amazon.com/gp/browse.html?node=1055398&ref_=nav_em_T1_0_4_16_1__home_storefront', 'https://www.amazon.com/gp/browse.html?node=14544458011&ref_=nav_em_T1_0_4_16_2_home_shopbyroom', 'https://www.amazon.com/scout?ref_=nav_em_T1_0_4_16_3_home_sbl', 'https://www.amazon.com/showroom?ref_=nav_em_T1_0_4_16_4_srm_hm_dsk', 'https://www.amazon.com/gp/browse.html?node=1063278&ref_=nav_em_T1_0_4_16_5_home_homedecor', 'https://www.amazon.com/gp/browse.html?node=1063306&ref_=nav_em_T1_0_4_16_6__furn', 'https://www.amazon.com/gp/browse.html?node=284507&ref_=nav_em_T1_0_4_16_7__ki', 'https://www.amazon.com/gp/browse.html?node=1057792&ref_=nav_em_T1_0_4_16_8__bb', 'https://www.amazon.com/gp/browse.html?node=2972638011&ref_=nav_em_T1_0_4_16_9__lp', 'https://www.amazon.com/gp/browse.html?node=3732961&ref_=nav_em_T1_0_4_16_10_home_mattresses', 'https://www.amazon.com/gp/browse.html?node=495224&ref_=nav_em_T1_0_4_16_11_home_lighting', 'https://www.amazon.com/gp/browse.html?node=3610841&ref_=nav_em_T1_0_4_16_12_home_storageandorg', 'https://www.amazon.com/gp/browse.html?node=2619525011&ref_=nav_em_T1_0_4_16_13__ha', 'https://www.amazon.com/gp/browse.html?node=6685269011&ref_=nav_em_T1_0_4_16_14__fine_art', 'https://www.amazon.com/gp/browse.html?node=4991425011&ref_=nav_em_T1_0_4_16_15__collectibles_fine_art', 'https://www.amazon.com/gp/browse.html?node=2617941011&ref_=nav_em_T1_0_4_16_16__sch', 'https://www.amazon.com/gp/browse.html?node=2619533011&ref_=nav_em_T1_0_4_16_17__ps', 'https://www.amazon.com/gp/browse.html?node=901590&ref_=nav_em_T1_0_4_16_18__ep', 'https://www.amazon.com/gp/browse.html?node=228013&ref_=nav_em_T1_0_4_16_1__hi2', 'https://www.amazon.com/gp/browse.html?node=328182011&ref_=nav_em_T1_0_4_16_2__hi', 'https://www.amazon.com/gp/browse.html?node=495224&ref_=nav_em_T1_0_4_16_3__llf', 'https://www.amazon.com/gp/browse.html?node=3754161&ref_=nav_em_T1_0_4_16_4__kbf', 'https://www.amazon.com/gp/browse.html?node=289814&ref_=nav_em_T1_0_4_16_5__cookware', 'https://www.amazon.com/gp/browse.html?node=511228&ref_=nav_em_T1_0_4_16_6__hdw', 'https://www.amazon.com/gp/browse.html?node=6563140011&ref_=nav_em_T1_0_4_16_7__homaut', 'https://www.amazon.com/Low-Price-With-Free-Shipping/bbp?category=%2Fhome-decor&ref_=nav_em_T1_0_4_16_8_bbp_bb_01a411_in_sd_w_ur', 'https://www.amazon.com/gp/browse.html?node=10112676011&ref_=nav_em_T1_0_4_16_1_home_pinzon', 'https://www.amazon.com/gp/browse.html?node=7633572011&ref_=nav_em_T1_0_4_16_2_home_rivet', 'https://www.amazon.com/gp/browse.html?node=17384727011&ref_=nav_em_T1_0_4_16_3_home_stoneandbeam', 'https://www.amazon.com/gp/browse.html?node=12034488011&ref_=nav_em_T1_0_4_16_4_home_launchpad', 'https://www.amazon.com/gp/wedding/homepage?ref_=nav_em_T1_0_4_16_5_home_weddingregistry', 'https://www.amazon.com/move?ref_=nav_em_T1_0_4_16_6_home_amazonmove', 'https://www.amazon.com/yourpets?ref_=nav_em_T1_0_4_27_1__directory_pet_profiles', 'https://www.amazon.com/gp/browse.html?node=2975312011&ref_=nav_em_T1_0_4_27_2__sd_dg', 'https://www.amazon.com/gp/browse.html?node=2975359011&ref_=nav_em_T1_0_4_27_3__sd_df', 'https://www.amazon.com/gp/browse.html?node=2975241011&ref_=nav_em_T1_0_4_27_4__sd_ct', 'https://www.amazon.com/gp/browse.html?node=2975265011&ref_=nav_em_T1_0_4_27_5__sd_ctfd', 'https://www.amazon.com/gp/browse.html?node=2975446011&ref_=nav_em_T1_0_4_27_6__sd_fish', 'https://www.amazon.com/gp/browse.html?node=2975520011&ref_=nav_em_T1_0_4_27_7__sd_sa', 'https://www.amazon.com/gp/browse.html?node=2975221011&ref_=nav_em_T1_0_4_27_8__sd_bird', 'https://www.amazon.com/gp/browse.html?node=12007651011&ref_=nav_em_T1_0_4_27_9_sa_pets_db', 'https://www.amazon.com/restaurants?ref_=nav_em_T1_0_4_19_1_amzrst_all_topnav', 'https://www.amazon.com/restaurants/m/popular-restaurants?ref_=nav_em_T1_0_4_19_2_amzrst_popular_topnav', 'https://www.amazon.com/gp/browse.html?node=16310101&ref_=nav_em_T1_0_4_19_1__gro', 'https://www.amazon.com/gp/browse.html?node=10329849011&ref_=nav_em_T1_0_4_19_2_fresh', 'https://www.amazon.com/gp/browse.html?node=7301146011&ref_=nav_em_T1_0_4_19_3__prime_pantry', 'https://www.amazon.com/gp/browse.html?node=12034492011&ref_=nav_em_T1_0_4_19_4__lpd_gno_csmbl', 'https://www.amazon.com/gp/browse.html?node=5856181011&ref_=nav_em_T1_0_4_19_5__subscribe_save', 'https://www.amazon.com/gp/browse.html?node=13854994011&ref_=nav_em_T1_0_4_19_6__wickedlyprime', 'https://www.amazon.com/gp/browse.html?node=3760911&ref_=nav_em_T1_0_4_18_1__bty', 'https://www.amazon.com/gp/browse.html?node=7175545011&ref_=nav_em_T1_0_4_18_2__luxury_bty', 'https://www.amazon.com/gp/browse.html?node=14717647011&ref_=nav_em_T1_0_4_18_3__pro_skin', 'https://www.amazon.com/gp/browse.html?node=14760453011&ref_=nav_em_T1_0_4_18_4__salon_spa', 'https://www.amazon.com/gp/browse.html?node=6682399011&ref_=nav_em_T1_0_4_18_5__men_grooming', 'https://www.amazon.com/gp/browse.html?node=3760901&ref_=nav_em_T1_0_4_18_6__health_household_baby', 'https://www.amazon.com/gp/browse.html?node=3764441&ref_=nav_em_T1_0_4_18_7__vds', 'https://www.amazon.com/gp/browse.html?node=5856181011&ref_=nav_em_T1_0_4_18_1__subscribe_save', 'https://www.amazon.com/gp/browse.html?node=7301146011&ref_=nav_em_T1_0_4_18_2__prime_pantry', 'https://www.amazon.com/sample-boxes?ref_=nav_em_T1_0_4_18_3__sampling', 'https://www.amazon.com/gp/browse.html?node=2231352011&ref_=nav_em_T1_0_4_18_4__coupons', 'https://www.amazon.com/gp/browse.html?node=16143060011&ref_=nav_em_T1_0_4_18_5_sa_btyhpc_db', 'https://www.amazon.com/gp/browse.html?node=8514636011&ref_=nav_em_T1_0_4_18_6__elements', 'https://www.amazon.com/gp/browse.html?node=3760901&ref_=nav_em_T1_0_4_18_1__H_HH_T2', 'https://www.amazon.com/gp/browse.html?node=3764441&ref_=nav_em_T1_0_4_18_2__VDS_T2', 'https://www.amazon.com/gp/browse.html?node=15342811&ref_=nav_em_T1_0_4_18_3__HH_T2', 'https://www.amazon.com/gp/browse.html?node=3760941&ref_=nav_em_T1_0_4_18_4__HC_T2', 'https://www.amazon.com/gp/browse.html?node=6973663011&ref_=nav_em_T1_0_4_18_5__SN_T2', 'https://www.amazon.com/gp/browse.html?node=10787321&ref_=nav_em_T1_0_4_18_6__BC_T2', 'https://www.amazon.com/gp/browse.html?node=3775161&ref_=nav_em_T1_0_4_18_7__MSE_T2', 'https://www.amazon.com/gp/browse.html?node=10079996011&ref_=nav_em_T1_0_4_18_8__HW_T2', 'https://www.amazon.com/gp/browse.html?node=165793011&ref_=nav_em_T1_0_4_20_1__tg', 'https://www.amazon.com/gp/browse.html?node=165796011&ref_=nav_em_T1_0_4_20_2__ba', 'https://www.amazon.com/gp/browse.html?node=166764011&ref_=nav_em_T1_0_4_20_3__baby_diapers', 'https://www.amazon.com/gp/browse.html?node=471306&ref_=nav_em_T1_0_4_20_4__cvg', 'https://www.amazon.com/gp/family/signup?ref_=nav_em_T1_0_4_20_5__family', 'https://www.amazon.com/cr/forteens?ref_=nav_em_T1_0_4_20_6_TDEP', 'https://www.amazon.com/baby-reg/homepage?ref_=nav_em_T1_0_4_20_7__babyreg', 'https://www.amazon.com/gp/browse.html?node=12693418011&ref_=nav_em_T1_0_4_20_8__kidsbirthdaynew', 'https://www.amazon.com/gp/browse.html?node=12034506011&ref_=nav_em_T1_0_4_20_9__lpd_gno_toys', 'https://www.amazon.com/gp/browse.html?node=8514636011&ref_=nav_em_T1_0_4_20_10__elements_baby', 'https://www.amazon.com/gp/browse.html?node=12007650011&ref_=nav_em_T1_0_4_20_11_sa_baby_db', 'https://www.amazon.com/gp/browse.html?node=7147442011&ref_=nav_em_T1_0_4_20_1__toys_girls', 'https://www.amazon.com/gp/browse.html?node=7147443011&ref_=nav_em_T1_0_4_20_2__toys_boys', 'https://www.amazon.com/gp/browse.html?node=7147444011&ref_=nav_em_T1_0_4_20_3__toys_baby', 'https://www.amazon.com/teenshop?ref_=nav_em_T1_0_4_20_4_TDEP', 'https://www.amazon.com/gp/browse.html?node=7141123011&ref_=nav_em_T1_0_4_12_1__sft', 'https://www.amazon.com/gp/browse.html?node=7147440011&ref_=nav_em_T1_0_4_12_2__sft_women', 'https://www.amazon.com/gp/browse.html?node=7147441011&ref_=nav_em_T1_0_4_12_3__sft_men', 'https://www.amazon.com/gp/browse.html?node=7147442011&ref_=nav_em_T1_0_4_12_4__sft_girls', 'https://www.amazon.com/gp/browse.html?node=7147443011&ref_=nav_em_T1_0_4_12_5__sft_boys', 'https://www.amazon.com/gp/browse.html?node=7147444011&ref_=nav_em_T1_0_4_12_6__sft_baby', 'https://www.amazon.com/gp/browse.html?node=9479199011&ref_=nav_em_T1_0_4_12_7__sft_luggage', 'https://www.amazon.com/gp/browse.html?node=14807110011&ref_=nav_em_T1_0_4_12_8_tbyb_site_directory_tbyb_l0', 'https://www.amazon.com/gp/browse.html?node=9538491011&ref_=nav_em_T1_0_4_12_9__sft_sales', 'https://www.amazon.com/gp/browse.html?node=16334314011&ref_=nav_em_T1_0_4_12_1__OurBrands', 'https://www.amazon.com/stores/page/135F2992-CF34-468F-B67F-101F73A197E3?ref_=nav_em_T1_0_4_12_2__shopbop', 'https://www.amazon.com/gp/browse.html?node=11260432011&ref_=nav_em_T1_0_4_35_1__HM_Home', 'https://www.amazon.com/gp/browse.html?node=17296384011&ref_=nav_em_T1_0_4_35_2__HM_gifts', 'https://www.amazon.com/gp/browse.html?node=11403480011&ref_=nav_em_T1_0_4_35_3__HM_Jewelry', 'https://www.amazon.com/gp/browse.html?node=11403478011&ref_=nav_em_T1_0_4_35_4__HM_kitchen', 'https://www.amazon.com/gp/browse.html?node=14303223011&ref_=nav_em_T1_0_4_35_5__HM_wedding', 'https://www.amazon.com/gp/browse.html?node=17373067011&ref_=nav_em_T1_0_4_35_6__HM_clothingShoes', 'https://www.amazon.com/gp/browse.html?node=11403468011&ref_=nav_em_T1_0_4_35_7__HM_accessories', 'https://www.amazon.com/gp/browse.html?node=11403472011&ref_=nav_em_T1_0_4_35_8__HM_beauty', 'https://www.amazon.com/gp/browse.html?node=11435470011&ref_=nav_em_T1_0_4_35_9__HM_stationery', 'https://www.amazon.com/gp/browse.html?node=11403495011&ref_=nav_em_T1_0_4_35_10__HM_petsupplies', 'https://www.amazon.com/gp/browse.html?node=11403488011&ref_=nav_em_T1_0_4_35_11__HM_petsupplies', 'https://www.amazon.com/gp/browse.html?node=11434552011&ref_=nav_em_T1_0_4_35_12__HM_homedecor', 'https://www.amazon.com/gp/browse.html?node=11433412011&ref_=nav_em_T1_0_4_35_13__HM_artwork', 'https://www.amazon.com/gp/browse.html?node=11434959011&ref_=nav_em_T1_0_4_35_14__HM_kitchen', 'https://www.amazon.com/gp/browse.html?node=11433453011&ref_=nav_em_T1_0_4_35_15__HM_furniture', 'https://www.amazon.com/gp/browse.html?node=11403470011&ref_=nav_em_T1_0_4_35_16__HM_baby', 'https://www.amazon.com/gp/browse.html?node=13283810011&ref_=nav_em_T1_0_4_35_1__HM_mii', 'https://www.amazon.com/gp/browse.html?node=11444071011&ref_=nav_em_T1_0_4_22_1__sa_sp_athclg', 'https://www.amazon.com/gp/browse.html?node=3407731&ref_=nav_em_T1_0_4_22_2__sa_sp_exfit', 'https://www.amazon.com/gp/browse.html?node=706813011&ref_=nav_em_T1_0_4_22_3__hntfsh', 'https://www.amazon.com/gp/browse.html?node=706809011&ref_=nav_em_T1_0_4_22_4__sa_sp_team', 'https://www.amazon.com/gp/browse.html?node=3386071&ref_=nav_em_T1_0_4_22_5__sa_sp_fan', 'https://www.amazon.com/gp/browse.html?node=3410851&ref_=nav_em_T1_0_4_22_6__sa_sp_golf', 'https://www.amazon.com/gp/browse.html?node=706808011&ref_=nav_em_T1_0_4_22_7__sa_sp_gamerm', 'https://www.amazon.com/gp/browse.html?node=3250697011&ref_=nav_em_T1_0_4_22_8__sa_sp_sptcllct', 'https://www.amazon.com/gp/browse.html?node=10971181011&ref_=nav_em_T1_0_4_22_9__sa_sp_allsport', 'https://www.amazon.com/gp/browse.html?node=12034909011&ref_=nav_em_T1_0_4_22_10__lpd_gno_sports', 'https://www.amazon.com/gp/browse.html?node=3400371&ref_=nav_em_T1_0_4_22_1__sa_out_camphike', 'https://www.amazon.com/gp/browse.html?node=3403201&ref_=nav_em_T1_0_4_22_2__sa_out_cyc', 'https://www.amazon.com/gp/browse.html?node=11443874011&ref_=nav_em_T1_0_4_22_3__sa_out_outcloth', 'https://www.amazon.com/gp/browse.html?node=11051398011&ref_=nav_em_T1_0_4_22_4__sa_out_scooskate', 'https://www.amazon.com/gp/browse.html?node=11051399011&ref_=nav_em_T1_0_4_22_5__sa_out_water', 'https://www.amazon.com/gp/browse.html?node=2204518011&ref_=nav_em_T1_0_4_22_6__sa_out_wintersport', 'https://www.amazon.com/gp/browse.html?node=3402401&ref_=nav_em_T1_0_4_22_7__sa_out_climb', 'https://www.amazon.com/gp/browse.html?node=11051400011&ref_=nav_em_T1_0_4_22_8__sa_out_accout', 'https://www.amazon.com/gp/browse.html?node=706814011&ref_=nav_em_T1_0_4_22_9__sa_out_alloutrec', 'https://www.amazon.com/gp/browse.html?node=15684181&ref_=nav_em_T1_0_4_23_1__apa', 'https://www.amazon.com/gp/browse.html?node=15706941&ref_=nav_em_T1_0_4_23_2__ate', 'https://www.amazon.com/gp/browse.html?node=3248684011&ref_=nav_em_T1_0_4_23_3__ceg', 'https://www.amazon.com/gp/browse.html?node=15706571&ref_=nav_em_T1_0_4_23_4__wt', 'https://www.amazon.com/gp/browse.html?node=346333011&ref_=nav_em_T1_0_4_23_5__matv', 'https://www.amazon.com/gp/browse.html?node=10677469011&ref_=nav_em_T1_0_4_23_6_vdp_store', 'https://www.amazon.com/gp/your-garage/?ref_=nav_em_T1_0_4_23_7_au_pf_as_GNO', 'https://www.amazon.com/gp/browse.html?node=16310091&ref_=nav_em_T1_0_4_23_1__ind_sup', 'https://www.amazon.com/gp/browse.html?node=317970011&ref_=nav_em_T1_0_4_23_2__ind_lab', 'https://www.amazon.com/gp/browse.html?node=317971011&ref_=nav_em_T1_0_4_23_3__ind_jan', 'https://www.amazon.com/gp/browse.html?node=318135011&ref_=nav_em_T1_0_4_23_4__ind_saf', 'https://www.amazon.com/gp/browse.html?node=6054382011&ref_=nav_em_T1_0_4_23_5__ind_fs', 'https://www.amazon.com/gp/browse.html?node=256346011&ref_=nav_em_T1_0_4_23_6__ind_mh', 'https://www.amazon.com/wholefoods?ref_=nav_em_T1_0_3_NaN_1_explore_wf', 'https://www.amazon.com/wholefoodsdeals?ref_=nav_em_T1_0_3_NaN_2_wf_deals', 'https://www.amazon.com/b?ld=AZUSSOA-sitedirectory&node=12766669011&ref_=nav_em_T1_0_3_NaN_1_nav_cs_sell', 'https://www.amazon.com/gp/browse.html?node=17726333011&ref_=nav_em_T1_0_4_24_1__guru_gno', 'https://www.amazon.com/gp/product/B01N3JQ196?ref_=nav_em_T1_0_4_24_2__guru_gno', 'https://www.amazon.com/gp/product/B074TW1JKX?ref_=nav_em_T1_0_4_24_3__guru_gno', 'https://www.amazon.com/gp/product/B01N2B397N?ref_=nav_em_T1_0_4_24_4__guru_gno', 'https://www.amazon.com/gp/product/B074PHNBYN?ref_=nav_em_T1_0_4_24_5__guru_gno', 'https://www.amazon.com/gp/product/B01DCC4LQQ?ref_=nav_em_T1_0_4_24_6__guru_gno', 'https://www.amazon.com/gp/browse.html?node=12643063011&ref_=nav_em_T1_0_4_24_7__guru_gno', 'https://www.amazon.com/gp/browse.html?node=14586916011&ref_=nav_em_T1_0_4_24_8__guru_gno', 'https://www.amazon.com/gp/browse.html?node=10192836011&ref_=nav_em_T1_0_4_24_1__localsvs_ce', 'https://www.amazon.com/gp/browse.html?node=10192825011&ref_=nav_em_T1_0_4_24_2__localsvs_home', 'https://www.amazon.com/gp/browse.html?node=11525233011&ref_=nav_em_T1_0_4_24_3__localsvs_assembly', 'https://www.amazon.com/gp/browse.html?node=11525224011&ref_=nav_em_T1_0_4_24_4__localsvs_cleaning', 'https://www.amazon.com/gp/browse.html?node=10192830011&ref_=nav_em_T1_0_4_24_5__localsvs_plumbing', 'https://www.amazon.com/gp/browse.html?node=10192827011&ref_=nav_em_T1_0_4_24_6__localsvs_electrical', 'https://www.amazon.com/gp/browse.html?node=10192838011&ref_=nav_em_T1_0_4_24_7__localsvs_hometheater', 'https://www.amazon.com/gp/browse.html?node=8098158011&ref_=nav_em_T1_0_4_24_8__localsvs_all', 'https://www.amazon.com/iss/credit/storecardmember?plattr=PLCCGNO&ref_=nav_em_T1_0_4_28_1__credit_plcc', 'https://www.amazon.com/iss/credit/rewardscardmember?plattr=CBCCGNO&ref_=nav_em_T1_0_4_28_2__credit_cbcc', 'https://www.amazon.com/dp/B07CBJQS16?plattr=GNO_CCL&pr=ibprox&ref_=nav_em_T1_0_4_28_3__credit_ccl', 'https://www.amazon.com/gp/browse.html?node=3561432011&ref_=nav_em_T1_0_4_28_4_credit_ccmp', 'https://www.amazon.com/gp/browse.html?node=16218619011&ref_=nav_em_T1_0_4_28_1__credit_swp', 'https://www.amazon.com/gp/browse.html?node=14583169011&ref_=nav_em_T1_0_4_28_2__amzcash', 'https://www.amazon.com/gp/browse.html?node=388305011&ref_=nav_em_T1_0_4_28_3__credit_tfx', 'https://www.amazon.com/gp/browse.html?node=11453461011&ref_=nav_em_T1_0_4_28_4_gno_allowance', 'https://www.amazon.com/gp/browse.html?node=10232440011&ref_=nav_em_T1_0_4_28_5_gno_balance', 'https://www.amazon.com/gp/browse.html?node=12034488011&ref_=nav_em_T1_0_3_29_1_al_fsd_all', 'https://www.amazon.com/gp/browse.html?node=12034490011&ref_=nav_em_T1_0_3_29_2_al_fsd_gadgets', 'https://www.amazon.com/gp/browse.html?node=12034506011&ref_=nav_em_T1_0_3_29_3_al_fsd_toys', 'https://www.amazon.com/gp/browse.html?node=12034491011&ref_=nav_em_T1_0_3_29_4_al_fsd_house', 'https://www.amazon.com/gp/browse.html?node=12034493011&ref_=nav_em_T1_0_3_29_5_al_fsd_body', 'https://www.amazon.com/gp/browse.html?node=12034492011&ref_=nav_em_T1_0_3_29_6_al_fsd_food', 'https://www.amazon.com/gp/browse.html?node=12632031011&ref_=nav_em_T1_0_3_29_7_al_fsd_collections', 'https://www.amazon.com/gp/browse.html?node=13270237011&ref_=nav_em_T1_0_3_29_8_al_fsd_gifts', 'https://www.amazon.com/gp/browse.html?node=11024013011&ref_=nav_em_T1_0_3_30_1_full_store_dir', 'https://www.amazon.com/gp/browse.html?node=14498690011&ref_=nav_em_T1_0_3_31_1_all_subscribe', 'https://www.amazon.com/treasuretruck?ref_=nav_em_T1_0_3_32_1_sd_tt_start', 'https://www.amazon.com/gp/help/customer/display.html?nodeId=201910800&ref_=nav_em_T1_0_3_43_1_full_store_dir_AG_shipping', 'https://www.amazon.com/gp/browse.html?node=230659011&ref_=nav_em_T1_0_3_43_2_full_store_dir_VisitAg', 'https://www.amazon.com/photos/home?ref_=nav_em_T1_0_4_34_1__gw_prime_learn', 'https://www.amazon.com/photos/apps?ref_=nav_em_T1_0_4_34_2__gw_photos_apps', 'https://www.amazon.com/photos?sf=1&ref_=nav_em_T1_0_4_34_3__gw_photos_login', 'https://www.amazon.com/gp/browse.html?node=15547130011&ref_=nav_em_T1_0_4_34_1__gw_dr_about', 'https://www.amazon.com/gp/drive/download-apps?ref_=nav_em_T1_0_4_34_2__gw_dl_apps', 'https://www.amazon.com/clouddrive?sf=1&ref_=nav_em_T1_0_4_34_3__gw_drive_login', 'https://www.amazon.com/gp/browse.html?node=14866317011&ref_=nav_em_T1_0_4_34_1__gw_print_about', 'https://www.amazon.com/gp/browse.html?node=17879387011&ref_=nav_em_T1_0_3_30_1_sbp_21_all', 'https://www.amazon.com/gp/browse.html?node=17964635011&ref_=nav_em_T1_0_3_30_2_sbp_21_wob', 'https://www.amazon.com/gp/browse.html?node=17964634011&ref_=nav_em_T1_0_3_30_3_sbp_21_ffb', 'https://www.amazon.com/gp/browse.html?node=17964632011&ref_=nav_em_T1_0_3_30_4_sbp_21_art', 'https://www.amazon.com/gp/browse.html?node=17964637011&ref_=nav_em_T1_0_3_30_5_sbp_21_inn', 'https://www.amazon.com/gp/site-directory?ref_=nav_em_T1_0_2_2_33__fullstore', 'https://www.amazon.com/gp/css/homepage.html?ref_=nav_em_T1_0_1_0_2_ya', 'https://www.amazon.com/gp/customer-preferences/select-language/?preferencesReturnUrl=%2F&ref_=nav_em_T1_0_1_0_3_mozart', 'https://www.amazon.com/gp/navigation-country/select-country/?ref_=nav_em_T1_0_1_0_4_locale']

detail_url_list = []
detail_url_list2 = []


HOST = 'https://www.amazon.com'
headers ={
    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
    'accept-encoding': 'gzip, deflate, br',
    'accept-language': 'zh-CN,zh;q=0.9',
    'cache-control': 'no-cache',
    'cookie': 'session-id=134-7713137-0318165; ubid-main=134-1941950-8510221; x-wl-uid=1TQ5dHz9lotI7TJu+aSSZ3cWjhwQMBSdtiG1B26ZcHJVKXCrfmDxqyiv68htTrq3TUv6IOcombPQ=; session-id-time=2082787201l; session-token=k4dQGFWH5l9fzy8P50qdVGJOgG/tXtsya+aFp/60KBUmNyZ9KQnAwaT76c4DYKwhCbIfHo8HL+belb5LfQsEF/aBjUdQCJVZ8qjEh7d8WUIJ7XAWqU0rQReKUwNg5mUrh6DFvq1a0bvpLd+ohFitki/i3zvwANoydp2g8YLA77U7aERyE6+zjff+VAT5wkaV; csm-hit=adb:adblk_no&tb:05RDS2Y8BT07XZGM4NK8+b-70NP4EFN2PS0W9G4HXVG|1543498490326&t:1543410388180',
    'pragma': 'no-cache',
    'referer': 'https://www.amazon.com/s/ref=lp_2256164011_ex_n_1?rh=n%3A10329849011%2Cn%3A16310101%2Cn%3A%2116310211%2Cn%3A371469011&bbn=10329849011&ie=UTF8&qid=1543497206',
    'upgrade-insecure-requests': '1',
    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36'
}

proxy_num = 0
myip = ''
proxy = ''

async def fetch(session, url):
    try:
        if config.proxy_on:
            global proxy_num,myip,proxy
            if proxy_num %15==0:
                myip = config.get_ip(config.proxy_url)
                proxy = 'http://'+myip
            proxy_num += 1
            async with session.get(url,headers=headers,timeout=10,proxy=proxy) as response:
                return await response.text()
        else:
            async with session.get(url,headers=headers,timeout=10) as response:
                return await response.text()
    except:
        return None


async def get_url(url,thislist):
    async with aiohttp.ClientSession() as session:
        try:
            print(url)

            aiohtml = await fetch(session, url)
            html = HTML(aiohtml)
            detail_urls = html.xpath('//ul[@class="a-unordered-list a-nostyle a-vertical s-ref-indent-one"]//div[@aria-live="polite"]/li/span/a/@href|//ul[@class="a-unordered-list a-nostyle a-vertical s-ref-indent-two"]//div[@aria-live="polite"]/li/span/a/@href')
            for detail in detail_urls:
                if detail == '':
                    continue
                link = detail.replace('\r', '').replace('\t', '').replace('\n', '').strip()
                if link[0:6] == '/s/ref':
                    detailurl = HOST + link
                elif link[0:4] == 'http':
                    detailurl = link
                elif link[0] == '/':
                    continue
                else:
                    continue
                print('detail_url: ' + detailurl)
                thislist.append(detailurl)
                with open('success_detail.txt', 'a') as f:
                    f.write(detailurl + '\n')

        except:
            print('未知错误')
            with open('failed_index.txt', 'a') as f:
                f.write(url + '\n')



async def get_detail(url):
    async with aiohttp.ClientSession() as session:
        try:
            aiohtml = await fetch(session, url)
            html = HTML(aiohtml)
            name = html.xpath('string(//div[@class="a-section a-spacing-small a-spacing-top-small"]/span/span)')
            count = html.xpath('string(//span[@id="s-result-count"]/text())')
            endcount = re.search('.*?(\d+,\d+|\d+) results', count)
            if endcount:
                endcount = endcount.group(1)
            elif endcount == None:
                endcount = re.search('(\d+) result', count).group(1)

            if endcount == None:
                endcount = ''
            print(name + ' , ' + endcount)
            name = name.replace(',', '，')
            endcount = endcount.replace(',', '')
            url = url.replace(',', '，')
            with open('results.csv', 'a') as f:
                f.write(endcount + ',' + name + ',' + url + '\n')
        except:
            pass

async def main():
    async with aiohttp.ClientSession() as session:
        try:
            # url_list=['https://www.amazon.com/s/ref=lp_166359011_ex_n_1?rh=n%3A165793011&bbn=165793011&ie=UTF8&qid=1543571789']
            for url in url_list:
                await get_url(url,detail_url_list)

            for detail in detail_url_list:
                with open('all_url.txt','a') as f:
                    f.write(detail+'\n')

            for url in detail_url_list:
                await get_detail(url)
                await get_url(url,detail_url_list2)

            for detail in detail_url_list2:
                with open('all_url.txt', 'a') as f:
                    f.write(detail + '\n')

            for url in detail_url_list2:
                await get_detail(url)

            # print(detail_url_list)
            # print(detail_url_list2)
        except:
            print('未知错误')

loop = asyncio.get_event_loop()
loop.run_until_complete(main())






